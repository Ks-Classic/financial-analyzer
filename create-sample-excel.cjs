// サンプルExcelファイルを生成するスクリプト
// Node.jsで実行: node create-sample-excel.js

const XLSX = require('xlsx');

// サンプルデータ
const bsData = [
    ['', '', '貸借対照表', '', ''],
    ['', '', '(単位：百万円)', '', ''],
    ['', '', '', '', ''],
    ['', '科目', '当期', '前期', '増減'],
    ['【資産の部】', '', '', '', ''],
    ['', '流動資産', '', '', ''],
    ['', '  現金及び預金', 2345, 2123, 222],
    ['', '  売掛金', 3456, 3033, 423],
    ['', '  棚卸資産', 1234, 1156, 78],
    ['', '  流動資産合計', 7035, 6312, 723],
    ['', '固定資産', '', '', ''],
    ['', '  有形固定資産', 4567, 4352, 215],
    ['', '  無形固定資産', 890, 856, 34],
    ['', '  投資その他の資産', 2742, 2613, 129],
    ['', '  固定資産合計', 8199, 7821, 378],
    ['', '資産合計', 15234, 14133, 1101],
    ['', '', '', '', ''],
    ['【負債の部】', '', '', '', ''],
    ['', '流動負債', '', '', ''],
    ['', '  買掛金', 2345, 2234, 111],
    ['', '  短期借入金', 1234, 1000, 234],
    ['', '  流動負債合計', 3579, 3234, 345],
    ['', '固定負債', '', '', ''],
    ['', '  長期借入金', 3456, 3558, -102],
    ['', '  その他', 1421, 1398, 23],
    ['', '  固定負債合計', 4877, 4956, -79],
    ['', '負債合計', 8456, 8190, 266],
    ['', '', '', '', ''],
    ['【純資産の部】', '', '', '', ''],
    ['', '株主資本', 6778, 5943, 835],
    ['', '純資産合計', 6778, 5943, 835],
    ['', '負債純資産合計', 15234, 14133, 1101],
];

const plData = [
    ['', '', '損益計算書', '', ''],
    ['', '', '(単位：百万円)', '', ''],
    ['', '', '', '', ''],
    ['', '科目', '当期', '前期', '増減率'],
    ['', '売上高', 12456, 11500, '8.3%'],
    ['', '売上原価', 7854, 7130, '10.2%'],
    ['', '売上総利益', 4602, 4370, '5.3%'],
    ['', '', '', '', ''],
    ['', '販売費及び一般管理費', 3368, 3273, '2.9%'],
    ['', '  人件費', 1890, 1845, '2.4%'],
    ['', '  広告宣伝費', 456, 423, '7.8%'],
    ['', '  その他', 1022, 1005, '1.7%'],
    ['', '', '', '', ''],
    ['', '営業利益', 1234, 1097, '12.5%'],
    ['', '経常利益', 1189, 1056, '12.6%'],
    ['', '税引前当期純利益', 1145, 1023, '11.9%'],
    ['', '法人税等', 389, 348, '11.8%'],
    ['', '当期純利益', 756, 675, '12.0%'],
];

const cfData = [
    ['', '', 'キャッシュ・フロー計算書', '', ''],
    ['', '', '(単位：百万円)', '', ''],
    ['', '', '', '', ''],
    ['', '科目', '当期', '前期', ''],
    ['【営業活動によるキャッシュ・フロー】', '', '', '', ''],
    ['', '税引前当期純利益', 1145, 1023, ''],
    ['', '減価償却費', 456, 423, ''],
    ['', '運転資本の増減', -34, -56, ''],
    ['', '営業活動によるCF', 1567, 1390, ''],
    ['', '', '', '', ''],
    ['【投資活動によるキャッシュ・フロー】', '', '', '', ''],
    ['', '有形固定資産の取得', -312, -289, ''],
    ['', 'その他', -111, -98, ''],
    ['', '投資活動によるCF', -423, -387, ''],
    ['', '', '', '', ''],
    ['【財務活動によるキャッシュ・フロー】', '', '', '', ''],
    ['', '配当金の支払', -156, -145, ''],
    ['', '借入金返済', -78, -112, ''],
    ['', '財務活動によるCF', -234, -257, ''],
    ['', '', '', '', ''],
    ['', '現金及び現金同等物の増減', 910, 746, ''],
    ['', '期首残高', 1435, 689, ''],
    ['', '期末残高', 2345, 1435, ''],
];

// ワークブック作成
const wb = XLSX.utils.book_new();

// シート追加
const ws1 = XLSX.utils.aoa_to_sheet(bsData);
const ws2 = XLSX.utils.aoa_to_sheet(plData);
const ws3 = XLSX.utils.aoa_to_sheet(cfData);

XLSX.utils.book_append_sheet(wb, ws1, '貸借対照表');
XLSX.utils.book_append_sheet(wb, ws2, '損益計算書');
XLSX.utils.book_append_sheet(wb, ws3, 'キャッシュフロー');

// ファイル出力
XLSX.writeFile(wb, 'sample_financial_report.xlsx');
console.log('サンプルExcelファイルを作成しました: sample_financial_report.xlsx');
